<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Action View Form Helpers · Rails Setup</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Forms in web applications are an essential interface for user input. However, form markup can quickly become tedious to write and maintain because of the need to handle form control naming and its numerous attributes. Rails does away with this complexity by providing view helpers for generating form markup. However, since these helpers have different use cases, developers need to know the differences between the helper methods before putting them to use.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Action View Form Helpers · Rails Setup"/><meta property="og:type" content="website"/><meta property="og:url" content="https://HenryTabima.github.io/rails-setup/"/><meta property="og:description" content="&lt;p&gt;Forms in web applications are an essential interface for user input. However, form markup can quickly become tedious to write and maintain because of the need to handle form control naming and its numerous attributes. Rails does away with this complexity by providing view helpers for generating form markup. However, since these helpers have different use cases, developers need to know the differences between the helper methods before putting them to use.&lt;/p&gt;
"/><meta property="og:image" content="https://HenryTabima.github.io/rails-setup/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://HenryTabima.github.io/rails-setup/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/rails-setup/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/rails-setup/js/scrollSpy.js"></script><link rel="stylesheet" href="/rails-setup/css/main.css"/><script src="/rails-setup/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/rails-setup/"><img class="logo" src="/rails-setup/img/favicon.ico" alt="Rails Setup"/><h2 class="headerTitleWithLogo">Rails Setup</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/rails-setup/docs/rails/getting-started" target="_self">Rails</a></li><li class=""><a href="/rails-setup/docs/devise/overview" target="_self">Devise</a></li><li class=""><a href="https://github.com/HenryTabima/rails-setup" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Views</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Start Here<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/getting-started">Getting Started with Rails</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/development-dependencies-install">Development Dependencies Install</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Models<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-basics">Active Record Basics</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-migrations">Active Record Migrations</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-validations">Active Record Validations</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-callbacks">Active Record Callbacks</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-associations">Active Record Associations</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-query">Active Record Query Interface</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/multiple-databases">Multiple Databases with Active Record</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-record-postgresql">Active Record and PostgreSQL</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Views<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/layouts-and-rendering">Layouts and Rendering in Rails</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/action-view">Action View Overview</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/rails-setup/docs/rails/action-view-form-helpers">Action View Form Helpers</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Controllers<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/action-controller">Action Controller Overview</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/rails-routing">Rails Routing from the Outside In</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Other Components<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-support-core">Active Support Core Extensions</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-support-instrumentation">Active Support Instrumentation</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/action-mailer">Action Mailer Basics</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/action-mailbox">Action Mailbox Basics</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-model">Active Model Basics</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-job">Active Job Basics</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/action-text">Action Text Overview</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/active-storage">Active Storage Overview</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/action-cable">Action Cable Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Digging Deeper<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/rails-i18n">Rails Internationalization (I18n) API</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/testing-rails">Testing Rails Applications</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/securing-rails">Securing Rails Applications</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/debugging-rails">Debugging Rails Applications</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/configuring-rails">Configuring Rails Applications</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/rails-command-line">The Rails Command Line</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/asset-pipeline">The Asset Pipeline</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/working-with-javascript">Working with JavaScript in Rails</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/autoloading-and-reloading">Autoloading and Reloading Constants</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/caching-with-rails">Caching with Rails: An Overview</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/api-only-apps">Using Rails for API-only Applications</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/threading">Threading and Code Execution in Rails</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/initialization">The Rails Initialization Process</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/engines">Getting Started with Engines</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Extending Rails<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/rails-on-rack">Rails on Rack</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/generators-&amp;-templates">Creating and Customizing Rails Generators &amp; Templates</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/application-templates">Rails Application Templates</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/creating-rails-plugins">The Basics of Creating Rails Plugins</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Contributions<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/contributing-to-rails">Contributing to Ruby on Rails</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/api-documentation">API Documentation Guidelines</a></li><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/guides-guidelines">Ruby on Rails Guides Guidelines</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Policies<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/rails-setup/docs/rails/maintenance-policy">Maintenance Policy for Ruby on Rails</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Action View Form Helpers</h1></header><article><div><span><p>Forms in web applications are an essential interface for user input. However, form markup can quickly become tedious to write and maintain because of the need to handle form control naming and its numerous attributes. Rails does away with this complexity by providing view helpers for generating form markup. However, since these helpers have different use cases, developers need to know the differences between the helper methods before putting them to use.</p>
<p>After reading this guide, you will know:</p>
<ul>
<li>How to create search forms and similar kind of generic forms not representing any specific model in your application.</li>
<li>How to make model-centric forms for creating and editing specific database records.</li>
<li>How to generate select boxes from multiple types of data.</li>
<li>What date and time helpers Rails provides.</li>
<li>What makes a file upload form different.</li>
<li>How to post forms to external resources and specify setting an <code>authenticity_token</code>.</li>
<li>How to build complex forms.</li>
</ul>
<hr>
<p>NOTE: This guide is not intended to be a complete documentation of available form helpers and their arguments. Please visit <a href="https://api.rubyonrails.org/">the Rails API documentation</a> for a complete reference.</p>
<h2><a class="anchor" aria-hidden="true" id="dealing-with-basic-forms"></a><a href="#dealing-with-basic-forms" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dealing with Basic Forms</h2>
<p>The main form helper is <code>form_with</code>.</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-keyword">do</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  Form contents
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>When called without arguments like this, it creates a form tag which, when submitted, will POST to the current page. For instance, assuming the current page is a home page, the generated HTML will look like this:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">data-remote</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"authenticity_token"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"J7CBxfHalt49OSHp27hblqK20c9PgwJ108nDHX/8Cts="</span> /&gt;</span>
  Form contents
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>You'll notice that the HTML contains an <code>input</code> element with type <code>hidden</code>. This <code>input</code> is important, because non-GET form cannot be successfully submitted without it.
The hidden input element with the name <code>authenticity_token</code> is a security feature of Rails called <strong>cross-site request forgery protection</strong>, and form helpers generate it for every non-GET form (provided that this security feature is enabled). You can read more about this in the <a href="security.html#cross-site-request-forgery-csrf">Securing Rails Applications</a> guide.</p>
<h3><a class="anchor" aria-hidden="true" id="a-generic-search-form"></a><a href="#a-generic-search-form" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A Generic Search Form</h3>
<p>One of the most basic forms you see on the web is a search form. This form contains:</p>
<ul>
<li>a form element with &quot;GET&quot; method,</li>
<li>a label for the input,</li>
<li>a text input element, and</li>
<li>a submit element.</li>
</ul>
<p>To create this form you will use <code>form_with</code>, <code>label_tag</code>, <code>text_field_tag</code>, and <code>submit_tag</code>, respectively. Like this:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with(<span class="hljs-symbol">url:</span> <span class="hljs-string">"/search"</span>, <span class="hljs-symbol">method:</span> <span class="hljs-string">"get"</span>) <span class="hljs-keyword">do</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> label_tag(<span class="hljs-symbol">:q</span>, <span class="hljs-string">"Search for:"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> text_field_tag(<span class="hljs-symbol">:q</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> submit_tag(<span class="hljs-string">"Search"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>This will generate the following HTML:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/search"</span> <span class="hljs-attr">data-remote</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"get"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"q"</span>&gt;</span>Search for:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"q"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"q"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"commit"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Search"</span> <span class="hljs-attr">data-disable-with</span>=<span class="hljs-string">"Search"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>TIP: Passing <code>url: my_specified_path</code> to <code>form_with</code> tells the form where to make the request. However, as explained below, you can also pass ActiveRecord objects to the form.</p>
<p>TIP: For every form input, an ID attribute is generated from its name (<code>&quot;q&quot;</code> in above example). These IDs can be very useful for CSS styling or manipulation of form controls with JavaScript.</p>
<p>IMPORTANT: Use &quot;GET&quot; as the method for search forms. This allows users to bookmark a specific search and get back to it. More generally Rails encourages you to use the right HTTP verb for an action.</p>
<h3><a class="anchor" aria-hidden="true" id="helpers-for-generating-form-elements"></a><a href="#helpers-for-generating-form-elements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Helpers for Generating Form Elements</h3>
<p>Rails provides a series of helpers for generating form elements such as
checkboxes, text fields, and radio buttons. These basic helpers, with names
ending in <code>_tag</code> (such as <code>text_field_tag</code> and <code>check_box_tag</code>), generate just a
single <code>&lt;input&gt;</code> element. The first parameter to these is always the name of the
input. When the form is submitted, the name will be passed along with the form
data, and will make its way to the <code>params</code> in the controller with the
value entered by the user for that field. For example, if the form contains
<code>&lt;%= text_field_tag(:query) %&gt;</code>, then you would be able to get the value of this
field in the controller with <code>params[:query]</code>.</p>
<p>When naming inputs, Rails uses certain conventions that make it possible to submit parameters with non-scalar values such as arrays or hashes, which will also be accessible in <code>params</code>. You can read more about them in chapter <a href="#understanding-parameter-naming-conventions">Understanding Parameter Naming Conventions</a> of this guide. For details on the precise usage of these helpers, please refer to the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html">API documentation</a>.</p>
<h4><a class="anchor" aria-hidden="true" id="checkboxes"></a><a href="#checkboxes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Checkboxes</h4>
<p>Checkboxes are form controls that give the user a set of options they can enable or disable:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> check_box_tag(<span class="hljs-symbol">:pet_dog</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> label_tag(<span class="hljs-symbol">:pet_dog</span>, <span class="hljs-string">"I own a dog"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> check_box_tag(<span class="hljs-symbol">:pet_cat</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> label_tag(<span class="hljs-symbol">:pet_cat</span>, <span class="hljs-string">"I own a cat"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>This generates the following:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"pet_dog"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"pet_dog"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"pet_dog"</span>&gt;</span>I own a dog<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"pet_cat"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"pet_cat"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"pet_cat"</span>&gt;</span>I own a cat<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
</code></pre>
<p>The first parameter to <code>check_box_tag</code>, of course, is the name of the input. The second parameter, naturally, is the value of the input. This value will be included in the form data (and be present in <code>params</code>) when the checkbox is checked.</p>
<h4><a class="anchor" aria-hidden="true" id="radio-buttons"></a><a href="#radio-buttons" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Radio Buttons</h4>
<p>Radio buttons, while similar to checkboxes, are controls that specify a set of options in which they are mutually exclusive (i.e., the user can only pick one):</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> radio_button_tag(<span class="hljs-symbol">:age</span>, <span class="hljs-string">"child"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> label_tag(<span class="hljs-symbol">:age_child</span>, <span class="hljs-string">"I am younger than 21"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> radio_button_tag(<span class="hljs-symbol">:age</span>, <span class="hljs-string">"adult"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> label_tag(<span class="hljs-symbol">:age_adult</span>, <span class="hljs-string">"I am over 21"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>Output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"age_child"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"age"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"child"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"age_child"</span>&gt;</span>I am younger than 21<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"age_adult"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"age"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"adult"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"age_adult"</span>&gt;</span>I am over 21<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
</code></pre>
<p>As with <code>check_box_tag</code>, the second parameter to <code>radio_button_tag</code> is the value of the input. Because these two radio buttons share the same name (<code>age</code>), the user will only be able to select one of them, and <code>params[:age]</code> will contain either <code>&quot;child&quot;</code> or <code>&quot;adult&quot;</code>.</p>
<p>NOTE: Always use labels for checkbox and radio buttons. They associate text with a specific option and,
by expanding the clickable region,
make it easier for users to click the inputs.</p>
<h3><a class="anchor" aria-hidden="true" id="other-helpers-of-interest"></a><a href="#other-helpers-of-interest" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other Helpers of Interest</h3>
<p>Other form controls worth mentioning are textareas, password fields,
hidden fields, search fields, telephone fields, date fields, time fields,
color fields, datetime-local fields, month fields, week fields,
URL fields, email fields, number fields, and range fields:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> text_area_tag(<span class="hljs-symbol">:message</span>, <span class="hljs-string">"Hi, nice site"</span>, <span class="hljs-symbol">size:</span> <span class="hljs-string">"24x6"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> password_field_tag(<span class="hljs-symbol">:password</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> hidden_field_tag(<span class="hljs-symbol">:parent_id</span>, <span class="hljs-string">"5"</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> search_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:name</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> telephone_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:phone</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> date_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:born_on</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> datetime_local_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:graduation_day</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> month_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:birthday_month</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> week_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:birthday_week</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> url_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:homepage</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> email_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:address</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> color_field(<span class="hljs-symbol">:user</span>, <span class="hljs-symbol">:favorite_color</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> time_field(<span class="hljs-symbol">:task</span>, <span class="hljs-symbol">:started_at</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> number_field(<span class="hljs-symbol">:product</span>, <span class="hljs-symbol">:price</span>, <span class="hljs-symbol">in:</span> <span class="hljs-number">1.0</span>..<span class="hljs-number">20.0</span>, <span class="hljs-symbol">step:</span> <span class="hljs-number">0</span>.<span class="hljs-number">5</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> range_field(<span class="hljs-symbol">:product</span>, <span class="hljs-symbol">:discount</span>, <span class="hljs-symbol">in:</span> <span class="hljs-number">1</span>..<span class="hljs-number">100</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>Output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"6"</span>&gt;</span>Hi, nice site<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"parent_id"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"parent_id"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"5"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_name"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[name]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"search"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_phone"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[phone]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"tel"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_born_on"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[born_on]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"date"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_graduation_day"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[graduation_day]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"datetime-local"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_birthday_month"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[birthday_month]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"month"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_birthday_week"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[birthday_week]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"week"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_homepage"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[homepage]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"url"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_address"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[address]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user_favorite_color"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"user[favorite_color]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"color"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"#000000"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"task_started_at"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"task[started_at]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"time"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"product_price"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"20.0"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"1.0"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"product[price]"</span> <span class="hljs-attr">step</span>=<span class="hljs-string">"0.5"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"product_discount"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"product[discount]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span> /&gt;</span>
</code></pre>
<p>Hidden inputs are not shown to the user but instead hold data like any textual input. Values inside them can be changed with JavaScript.</p>
<p>IMPORTANT: The search, telephone, date, time, color, datetime, datetime-local,
month, week, URL, email, number, and range inputs are HTML5 controls.
If you require your app to have a consistent experience in older browsers,
you will need an HTML5 polyfill (provided by CSS and/or JavaScript).
There is definitely <a href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills">no shortage of solutions for this</a>, although a popular tool at the moment is
<a href="https://modernizr.com/">Modernizr</a>, which provides a simple way to add functionality based on the presence of
detected HTML5 features.</p>
<p>TIP: If you're using password input fields (for any purpose), you might want to configure your application to prevent those parameters from being logged. You can learn about this in the <a href="/rails-setup/docs/rails/securing-rails#logging">Securing Rails Applications</a> guide.</p>
<h2><a class="anchor" aria-hidden="true" id="dealing-with-model-objects"></a><a href="#dealing-with-model-objects" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dealing with Model Objects</h2>
<h3><a class="anchor" aria-hidden="true" id="model-object-helpers"></a><a href="#model-object-helpers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Model Object Helpers</h3>
<p>A particularly common task for a form is editing or creating a model object. While the <code>*_tag</code> helpers can certainly be used for this task they are somewhat verbose as for each tag you would have to ensure the correct parameter name is used and set the default value of the input appropriately. Rails provides helpers tailored to this task. These helpers lack the <code>_tag</code> suffix, for example <code>text_field</code>, <code>text_area</code>.</p>
<p>For these helpers the first argument is the name of an instance variable and the second is the name of a method (usually an attribute) to call on that object. Rails will set the value of the input control to the return value of that method for the object and set an appropriate input name. If your controller has defined <code>@person</code> and that person's name is Henry then a form containing:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> text_field(<span class="hljs-symbol">:person</span>, <span class="hljs-symbol">:name</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>will produce output similar to</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_name"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[name]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Henry"</span> /&gt;</span>
</span></code></pre>
<p>Upon form submission the value entered by the user will be stored in <code>params[:person][:name]</code>.</p>
<p>WARNING: You must pass the name of an instance variable, i.e. <code>:person</code> or <code>&quot;person&quot;</code>, not an actual instance of your model object.</p>
<p>Rails provides helpers for displaying the validation errors associated with a model object. These are covered in detail by the <a href="active_record_validations.html#displaying-validation-errors-in-views">Active Record Validations</a> guide.</p>
<h3><a class="anchor" aria-hidden="true" id="binding-a-form-to-an-object"></a><a href="#binding-a-form-to-an-object" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Binding a Form to an Object</h3>
<p>While this is an increase in comfort it is far from perfect. If <code>Person</code> has many attributes to edit then we would be repeating the name of the edited object many times. What we want to do is somehow bind a form to a model object, which is exactly what <code>form_with</code> with <code>:model</code> does.</p>
<p>Assume we have a controller for dealing with articles <code>app/controllers/articles_controller.rb</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">new</span></span>
  @article = Article.new
<span class="hljs-keyword">end</span>
</code></pre>
<p>The corresponding view <code>app/views/articles/new.html.erb</code> using <code>form_with</code> looks like this:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @article, <span class="hljs-class"><span class="hljs-keyword">class</span>: "<span class="hljs-title">nifty_form</span>" <span class="hljs-title">do</span> |<span class="hljs-title">f</span>| </span></span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.text_field <span class="hljs-symbol">:title</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.text_area <span class="hljs-symbol">:body</span>, <span class="hljs-symbol">size:</span> <span class="hljs-string">"60x12"</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.submit <span class="hljs-string">"Create"</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>There are a few things to note here:</p>
<ul>
<li><code>@article</code> is the actual object being edited.</li>
<li>There is a single hash of options. HTML options (except <code>id</code> and <code>class</code>) are passed in the <code>:html</code> hash. Also you can provide a <code>:namespace</code> option for your form to ensure uniqueness of id attributes on form elements. The scope attribute will be prefixed with underscore on the generated HTML id.</li>
<li>The <code>form_with</code> method yields a <strong>form builder</strong> object (the <code>f</code> variable).</li>
<li>If you wish to direct your form request to a particular URL, you would use <code>form_with url: my_nifty_url_path</code> instead. To see more in depth options on what <code>form_with</code> accepts be sure to <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_with">check out the API documentation</a>.</li>
<li>Methods to create form controls are called <strong>on</strong> the form builder object <code>f</code>.</li>
</ul>
<p>The resulting HTML is:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nifty_form"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/articles"</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span> <span class="hljs-attr">data-remote</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"authenticity_token"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"NRkFyRWxdYNfUg7vYxLOp2SLf93lvnl+QwDWorR42Dp6yZXPhHEb6arhDOIWcqGit8jfnrPwL781/xlrzj63TA=="</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"article[title]"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"article_title"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"article[body]"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"article_body"</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">"60"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"12"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"commit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Create"</span> <span class="hljs-attr">data-disable-with</span>=<span class="hljs-string">"Create"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>The object passed as <code>:model</code> in <code>form_with</code> controls the key used in <code>params</code> to access the form's values. Here the name is <code>article</code> and so all the inputs have names of the form <code>article[attribute_name]</code>. Accordingly, in the <code>create</code> action <code>params[:article]</code> will be a hash with keys <code>:title</code> and <code>:body</code>. You can read more about the significance of input names in chapter <a href="#understanding-parameter-naming-conventions">Understanding Parameter Naming Conventions</a> of this guide.</p>
<p>TIP: Conventionally your inputs will mirror model attributes. However, they don't have to! If there is other information you need you can include it in your form just as with attributes and access it via <code>params[:article][:my_nifty_non_attribute_input]</code>.</p>
<p>The helper methods called on the form builder are identical to the model object helpers except that it is not necessary to specify which object is being edited since this is already managed by the form builder.</p>
<p>You can create a similar binding without actually creating <code>&lt;form&gt;</code> tags with the <code>fields_for</code> helper. This is useful for editing additional model objects with the same form. For example, if you had a <code>Person</code> model with an associated <code>ContactDetail</code> model, you could create a form for creating both like so:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|person_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> person_form.text_field <span class="hljs-symbol">:name</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> fields_for <span class="hljs-symbol">:contact_detail</span>, @person.contact_detail <span class="hljs-keyword">do</span> <span class="hljs-params">|contact_detail_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> contact_detail_form.text_field <span class="hljs-symbol">:phone_number</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>which produces the following output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/people"</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span> <span class="hljs-attr">data-remote</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"authenticity_token"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"bL13x72pldyDD8bgtkjKQakJCpd4A8JdXGbfksxBDHdf1uC0kCMqe2tvVdUYfidJt0fj3ihC4NxiVHv8GVYxJA=="</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[name]"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_name"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"contact_detail[phone_number]"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"contact_detail_phone_number"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>The object yielded by <code>fields_for</code> is a form builder like the one yielded by <code>form_with</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="relying-on-record-identification"></a><a href="#relying-on-record-identification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relying on Record Identification</h3>
<p>The Article model is directly available to users of the application, so - following the best practices for developing with Rails - you should declare it <strong>a resource</strong>:</p>
<pre><code class="hljs css language-ruby">resources <span class="hljs-symbol">:articles</span>
</code></pre>
<p>TIP: Declaring a resource has a number of side effects. See <a href="routing.html#resource-routing-the-rails-default">Rails Routing from the Outside In</a> guide for more information on setting up and using resources.</p>
<p>When dealing with RESTful resources, calls to <code>form_with</code> can get significantly easier if you rely on <strong>record identification</strong>. In short, you can just pass the model instance and have Rails figure out model name and the rest:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">## Creating a new article</span>
<span class="hljs-comment"># long-style:</span>
form_with(<span class="hljs-symbol">model:</span> @article, <span class="hljs-symbol">url:</span> articles_path)
short-<span class="hljs-symbol">style:</span>
form_with(<span class="hljs-symbol">model:</span> @article)

<span class="hljs-comment">## Editing an existing article</span>
<span class="hljs-comment"># long-style:</span>
form_with(<span class="hljs-symbol">model:</span> @article, <span class="hljs-symbol">url:</span> article_path(@article), <span class="hljs-symbol">method:</span> <span class="hljs-string">"patch"</span>)
<span class="hljs-comment"># short-style:</span>
form_with(<span class="hljs-symbol">model:</span> @article)
</code></pre>
<p>Notice how the short-style <code>form_with</code> invocation is conveniently the same, regardless of the record being new or existing. Record identification is smart enough to figure out if the record is new by asking <code>record.new_record?</code>. It also selects the correct path to submit to, and the name based on the class of the object.</p>
<p>WARNING: When you're using STI (single-table inheritance) with your models, you can't rely on record identification on a subclass if only their parent class is declared a resource. You will have to specify <code>:url</code>, and <code>:scope</code> (the model name) explicitly.</p>
<h4><a class="anchor" aria-hidden="true" id="dealing-with-namespaces"></a><a href="#dealing-with-namespaces" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dealing with Namespaces</h4>
<p>If you have created namespaced routes, <code>form_with</code> has a nifty shorthand for that too. If your application has an admin namespace then</p>
<pre><code class="hljs css language-ruby">form_with <span class="hljs-symbol">model:</span> [<span class="hljs-symbol">:admin</span>, @article]
</code></pre>
<p>will create a form that submits to the <code>ArticlesController</code> inside the admin namespace (submitting to <code>admin_article_path(@article)</code> in the case of an update). If you have several levels of namespacing then the syntax is similar:</p>
<pre><code class="hljs css language-ruby">form_with <span class="hljs-symbol">model:</span> [<span class="hljs-symbol">:admin</span>, <span class="hljs-symbol">:management</span>, @article]
</code></pre>
<p>For more information on Rails' routing system and the associated conventions, please see <a href="/rails-setup/docs/rails/rails-routing">Rails Routing from the Outside In</a> guide.</p>
<h3><a class="anchor" aria-hidden="true" id="how-do-forms-with-patch-put-or-delete-methods-work"></a><a href="#how-do-forms-with-patch-put-or-delete-methods-work" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do forms with PATCH, PUT, or DELETE methods work?</h3>
<p>The Rails framework encourages RESTful design of your applications, which means you'll be making a lot of &quot;PATCH&quot;, &quot;PUT&quot;, and &quot;DELETE&quot; requests (besides &quot;GET&quot; and &quot;POST&quot;). However, most browsers <em>don't support</em> methods other than &quot;GET&quot; and &quot;POST&quot; when it comes to submitting forms.</p>
<p>Rails works around this issue by emulating other methods over POST with a hidden input named <code>&quot;_method&quot;</code>, which is set to reflect the desired method:</p>
<pre><code class="hljs css language-ruby">form_with(<span class="hljs-symbol">url:</span> search_path, <span class="hljs-symbol">method:</span> <span class="hljs-string">"patch"</span>)
</code></pre>
<p>Output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/search"</span> <span class="hljs-attr">data-remote</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"_method"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"patch"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"authenticity_token"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"f755bb0ed134b76c432144748a6d4b7a7ddf2b71"</span> /&gt;</span>
  ...
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>When parsing POSTed data, Rails will take into account the special <code>_method</code> parameter and act as if the HTTP method was the one specified inside it (&quot;PATCH&quot; in this example).</p>
<p>IMPORTANT: All forms using <code>form_with</code> implement <code>remote: true</code> by default. These forms will submit data using an XHR (Ajax) request. To disable this include <code>local: true</code>. To dive deeper see <a href="working_with_javascript_in_rails.html#remote-elements">Working with JavaScript in Rails</a> guide.</p>
<h2><a class="anchor" aria-hidden="true" id="making-select-boxes-with-ease"></a><a href="#making-select-boxes-with-ease" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Making Select Boxes with Ease</h2>
<p>Select boxes in HTML require a significant amount of markup (one <code>OPTION</code> element for each option to choose from), therefore it makes the most sense for them to be dynamically generated.</p>
<p>Here is what the markup might look like:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"city_id"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"city_id"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>&gt;</span>Lisbon<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span>&gt;</span>Madrid<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"3"</span>&gt;</span>Berlin<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
</code></pre>
<p>Here you have a list of cities whose names are presented to the user. Internally the application only wants to handle their IDs so they are used as the options' value attribute. Let's see how Rails can help out here.</p>
<h3><a class="anchor" aria-hidden="true" id="the-select-and-option-tags"></a><a href="#the-select-and-option-tags" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Select and Option Tags</h3>
<p>The most generic helper is <code>select_tag</code>, which - as the name implies - simply generates the <code>SELECT</code> tag that encapsulates an options string:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> select_tag(<span class="hljs-symbol">:city_id</span>, raw(<span class="hljs-string">'&lt;option value="1"&gt;Lisbon&lt;/option&gt;&lt;option value="2"&gt;Madrid&lt;/option&gt;&lt;option value="3"&gt;Berlin&lt;/option&gt;'</span>)) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>This is a start, but it doesn't dynamically create the option tags. You can generate option tags with the <code>options_for_select</code> helper:</p>
<pre><code class="hljs css language-html+erb">&lt;%= options_for_select(<span class="hljs-string">[['Lisbon', 1], ['Madrid', 2], ['Berlin', 3]]</span>) %&gt;
</code></pre>
<p>Output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>&gt;</span>Lisbon<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span>&gt;</span>Madrid<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"3"</span>&gt;</span>Berlin<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
</code></pre>
<p>The first argument to <code>options_for_select</code> is a nested array where each element has two elements: option text (city name) and option value (city id). The option value is what will be submitted to your controller. Often this will be the id of a corresponding database object but this does not have to be the case.</p>
<p>Knowing this, you can combine <code>select_tag</code> and <code>options_for_select</code> to achieve the desired, complete markup:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> select_tag(<span class="hljs-symbol">:city_id</span>, options_for_select(...)) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p><code>options_for_select</code> allows you to pre-select an option by passing its value.</p>
<pre><code class="hljs css language-html+erb">&lt;%= options_for_select(<span class="hljs-string">[['Lisbon', 1], ['Madrid', 2], ['Berlin', 3]]</span>, <span class="hljs-number">2</span>) %&gt;
</code></pre>
<p>Output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>&gt;</span>Lisbon<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">selected</span>=<span class="hljs-string">"selected"</span>&gt;</span>Madrid<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"3"</span>&gt;</span>Berlin<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
</code></pre>
<p>Whenever Rails sees that the internal value of an option being generated matches this value, it will add the <code>selected</code> attribute to that option.</p>
<p>You can add arbitrary attributes to the options using hashes:</p>
<pre><code class="hljs css language-html+erb">&lt;<span class="hljs-comment">%= options_for_select(</span>
  [
    [<span class="hljs-string">'Lisbon'</span>, <span class="hljs-number">1</span>, { <span class="hljs-string">'data-size'</span> =&gt; <span class="hljs-string">'2.8 million'</span> }],
    [<span class="hljs-string">'Madrid'</span>, <span class="hljs-number">2</span>, { <span class="hljs-string">'data-size'</span> =&gt; <span class="hljs-string">'3.2 million'</span> }],
    [<span class="hljs-string">'Berlin'</span>, <span class="hljs-number">3</span>, { <span class="hljs-string">'data-size'</span> =&gt; <span class="hljs-string">'3.4 million'</span> }]
  ], <span class="hljs-number">2</span>
) <span class="hljs-comment">%&gt;</span>
</code></pre>
<p>Output:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">data-size</span>=<span class="hljs-string">"2.8 million"</span>&gt;</span>Lisbon<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">selected</span>=<span class="hljs-string">"selected"</span> <span class="hljs-attr">data-size</span>=<span class="hljs-string">"3.2 million"</span>&gt;</span>Madrid<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">data-size</span>=<span class="hljs-string">"3.4 million"</span>&gt;</span>Berlin<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="select-boxes-for-dealing-with-model-objects"></a><a href="#select-boxes-for-dealing-with-model-objects" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Select Boxes for Dealing with Model Objects</h3>
<p>In most cases form controls will be tied to a specific model and as you might expect Rails provides helpers tailored for that purpose. Consistent with other form helpers, when dealing with a model object drop the <code>_tag</code> suffix from <code>select_tag</code>:</p>
<p>If your controller has defined <code>@person</code> and that person's city_id is 2:</p>
<pre><code class="hljs css language-ruby">@person = Person.new(<span class="hljs-symbol">city_id:</span> <span class="hljs-number">2</span>)
</code></pre>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> select(<span class="hljs-symbol">:person</span>, <span class="hljs-symbol">:city_id</span>, [[<span class="hljs-string">'Lisbon'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'Madrid'</span>, <span class="hljs-number">2</span>], [<span class="hljs-string">'Berlin'</span>, <span class="hljs-number">3</span>]]) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>will produce output similar to</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[city_id]"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_city_id"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>&gt;</span>Lisbon<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">selected</span>=<span class="hljs-string">"selected"</span>&gt;</span>Madrid<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"3"</span>&gt;</span>Berlin<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
</code></pre>
<p>Notice that the third parameter, the options array, is the same kind of argument you pass to <code>options_for_select</code>. One advantage here is that you don't have to worry about pre-selecting the correct city if the user already has one - Rails will do this for you by reading from the <code>@person.city_id</code> attribute.</p>
<p>As with other helpers, if you were to use the <code>select</code> helper on a form builder scoped to the <code>@person</code> object, the syntax would be:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|person_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> person_form.select(<span class="hljs-symbol">:city_id</span>, [[<span class="hljs-string">'Lisbon'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'Madrid'</span>, <span class="hljs-number">2</span>], [<span class="hljs-string">'Berlin'</span>, <span class="hljs-number">3</span>]]) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>You can also pass a block to <code>select</code> helper:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|person_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> person_form.select(<span class="hljs-symbol">:city_id</span>) <span class="hljs-keyword">do</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> [[<span class="hljs-string">'Lisbon'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'Madrid'</span>, <span class="hljs-number">2</span>], [<span class="hljs-string">'Berlin'</span>, <span class="hljs-number">3</span>]].each <span class="hljs-keyword">do</span> <span class="hljs-params">|c|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> content_tag(<span class="hljs-symbol">:option</span>, c.first, <span class="hljs-symbol">value:</span> c.last) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>WARNING: If you are using <code>select</code> or similar helpers to set a <code>belongs_to</code> association you must pass the name of the foreign key (in the example above <code>city_id</code>), not the name of association itself.</p>
<p>WARNING: When <code>:include_blank</code> or <code>:prompt</code> are not present, <code>:include_blank</code> is forced true if the select attribute <code>required</code> is true, display <code>size</code> is one, and <code>multiple</code> is not true.</p>
<h3><a class="anchor" aria-hidden="true" id="option-tags-from-a-collection-of-arbitrary-objects"></a><a href="#option-tags-from-a-collection-of-arbitrary-objects" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Option Tags from a Collection of Arbitrary Objects</h3>
<p>Generating options tags with <code>options_for_select</code> requires that you create an array containing the text and value for each option. But what if you had a <code>City</code> model (perhaps an Active Record one) and you wanted to generate option tags from a collection of those objects? One solution would be to make a nested array by iterating over them:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> cities_array = City.all.map { <span class="hljs-params">|city|</span> [city.name, city.id] } </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> options_for_select(cities_array) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>This is a perfectly valid solution, but Rails provides a less verbose alternative: <code>options_from_collection_for_select</code>. This helper expects a collection of arbitrary objects and two additional arguments: the names of the methods to read the option <strong>value</strong> and <strong>text</strong> from, respectively:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> options_from_collection_for_select(City.all, <span class="hljs-symbol">:id</span>, <span class="hljs-symbol">:name</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>As the name implies, this only generates option tags. To generate a working select box you would need to use <code>collection_select</code>:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> collection_select(<span class="hljs-symbol">:person</span>, <span class="hljs-symbol">:city_id</span>, City.all, <span class="hljs-symbol">:id</span>, <span class="hljs-symbol">:name</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>As with other helpers, if you were to use the <code>collection_select</code> helper on a form builder scoped to the <code>@person</code> object, the syntax would be:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|person_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> person_form.collection_select(<span class="hljs-symbol">:city_id</span>, City.all, <span class="hljs-symbol">:id</span>, <span class="hljs-symbol">:name</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>NOTE: Pairs passed to <code>options_for_select</code> should have the text first and the value second, however with <code>options_from_collection_for_select</code> should have the value method first and the text method second.</p>
<h3><a class="anchor" aria-hidden="true" id="time-zone-and-country-select"></a><a href="#time-zone-and-country-select" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Time Zone and Country Select</h3>
<p>To leverage time zone support in Rails, you have to ask your users what time zone they are in. Doing so would require generating select options from a list of pre-defined <a href="https://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html"><code>ActiveSupport::TimeZone</code></a> objects using <code>collection_select</code>, but you can simply use the <code>time_zone_select</code> helper that already wraps this:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> time_zone_select(<span class="hljs-symbol">:person</span>, <span class="hljs-symbol">:time_zone</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>There is also <code>time_zone_options_for_select</code> helper for a more manual (therefore more customizable) way of doing this. Read the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-time_zone_options_for_select">API documentation</a> to learn about the possible arguments for these two methods.</p>
<p>Rails <em>used</em> to have a <code>country_select</code> helper for choosing countries, but this has been extracted to the <a href="https://github.com/stefanpenner/country_select">country_select plugin</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="using-date-and-time-form-helpers"></a><a href="#using-date-and-time-form-helpers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using Date and Time Form Helpers</h2>
<p>You can choose not to use the form helpers generating HTML5 date and time input fields and use the alternative date and time helpers. These date and time helpers differ from all the other form helpers in two important respects:</p>
<ul>
<li>Dates and times are not representable by a single input element. Instead, you have several, one for each component (year, month, day etc.) and so there is no single value in your <code>params</code> hash with your date or time.</li>
<li>Other helpers use the <code>_tag</code> suffix to indicate whether a helper is a barebones helper or one that operates on model objects. With dates and times, <code>select_date</code>, <code>select_time</code> and <code>select_datetime</code> are the barebones helpers, <code>date_select</code>, <code>time_select</code> and <code>datetime_select</code> are the equivalent model object helpers.</li>
</ul>
<p>Both of these families of helpers will create a series of select boxes for the different components (year, month, day etc.).</p>
<h3><a class="anchor" aria-hidden="true" id="barebones-helpers"></a><a href="#barebones-helpers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Barebones Helpers</h3>
<p>The <code>select_*</code> family of helpers take as their first argument an instance of <code>Date</code>, <code>Time</code>, or <code>DateTime</code> that is used as the currently selected value. You may omit this parameter, in which case the current date is used. For example:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> select_date Date.today, <span class="hljs-symbol">prefix:</span> <span class="hljs-symbol">:start_date</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>outputs (with actual option values omitted for brevity)</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"start_date_year"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"start_date[year]"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"start_date_month"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"start_date[month]"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"start_date_day"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"start_date[day]"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
</code></pre>
<p>The above inputs would result in <code>params[:start_date]</code> being a hash with keys <code>:year</code>, <code>:month</code>, <code>:day</code>. To get an actual <code>Date</code>, <code>Time</code>, or <code>DateTime</code> object you would have to extract these values and pass them to the appropriate constructor, for example:</p>
<pre><code class="hljs css language-ruby">Date.civil(params[<span class="hljs-symbol">:start_date</span>][<span class="hljs-symbol">:year</span>].to_i, params[<span class="hljs-symbol">:start_date</span>][<span class="hljs-symbol">:month</span>].to_i, params[<span class="hljs-symbol">:start_date</span>][<span class="hljs-symbol">:day</span>].to_i)
</code></pre>
<p>The <code>:prefix</code> option is the key used to retrieve the hash of date components from the <code>params</code> hash. Here it was set to <code>start_date</code>, if omitted it will default to <code>date</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="model-object-helpers-1"></a><a href="#model-object-helpers-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Model Object Helpers</h3>
<p><code>select_date</code> does not work well with forms that update or create Active Record objects as Active Record expects each element of the <code>params</code> hash to correspond to one attribute.
The model object helpers for dates and times submit parameters with special names; when Active Record sees parameters with such names it knows they must be combined with the other parameters and given to a constructor appropriate to the column type. For example:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> date_select <span class="hljs-symbol">:person</span>, <span class="hljs-symbol">:birth_date</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>outputs (with actual option values omitted for brevity)</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_birth_date_1i"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[birth_date(1i)]"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_birth_date_2i"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[birth_date(2i)]"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_birth_date_3i"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[birth_date(3i)]"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
</code></pre>
<p>which results in a <code>params</code> hash like</p>
<pre><code class="hljs css language-ruby">{<span class="hljs-string">'person'</span> =&gt; {<span class="hljs-string">'birth_date(1i)'</span> =&gt; <span class="hljs-string">'2008'</span>, <span class="hljs-string">'birth_date(2i)'</span> =&gt; <span class="hljs-string">'11'</span>, <span class="hljs-string">'birth_date(3i)'</span> =&gt; <span class="hljs-string">'22'</span>}}
</code></pre>
<p>When this is passed to <code>Person.new</code> (or <code>update</code>), Active Record spots that these parameters should all be used to construct the <code>birth_date</code> attribute and uses the suffixed information to determine in which order it should pass these parameters to functions such as <code>Date.civil</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="common-options"></a><a href="#common-options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Common Options</h3>
<p>Both families of helpers use the same core set of functions to generate the individual select tags and so both accept largely the same options. In particular, by default Rails will generate year options 5 years either side of the current year. If this is not an appropriate range, the <code>:start_year</code> and <code>:end_year</code> options override this. For an exhaustive list of the available options, refer to the <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html">API documentation</a>.</p>
<p>As a rule of thumb you should be using <code>date_select</code> when working with model objects and <code>select_date</code> in other cases, such as a search form which filters results by date.</p>
<h3><a class="anchor" aria-hidden="true" id="individual-components"></a><a href="#individual-components" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Individual Components</h3>
<p>Occasionally you need to display just a single date component such as a year or a month. Rails provides a series of helpers for this, one for each component <code>select_year</code>, <code>select_month</code>, <code>select_day</code>, <code>select_hour</code>, <code>select_minute</code>, <code>select_second</code>. These helpers are fairly straightforward. By default they will generate an input field named after the time component (for example, &quot;year&quot; for <code>select_year</code>, &quot;month&quot; for <code>select_month</code> etc.) although this can be overridden with the <code>:field_name</code> option. The <code>:prefix</code> option works in the same way that it does for <code>select_date</code> and <code>select_time</code> and has the same default value.</p>
<p>The first parameter specifies which value should be selected and can either be an instance of a <code>Date</code>, <code>Time</code>, or <code>DateTime</code>, in which case the relevant component will be extracted, or a numerical value. For example:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> select_year(<span class="hljs-number">2009</span>) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> select_year(Time.new(<span class="hljs-number">2009</span>)) </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>will produce the same output and the value chosen by the user can be retrieved by <code>params[:date][:year]</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="uploading-files"></a><a href="#uploading-files" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uploading Files</h2>
<p>A common task is uploading some sort of file, whether it's a picture of a person or a CSV file containing data to process. The most important thing to remember with file uploads is that the rendered form's enctype attribute <strong>must</strong> be set to &quot;multipart/form-data&quot;. If you use <code>form_with</code> with <code>:model</code>, this is done automatically. If you use <code>form_with</code> without <code>:model</code>, you must set it yourself, as per the following example.</p>
<p>The following two forms both upload a file.</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with(<span class="hljs-symbol">url:</span> {<span class="hljs-symbol">action:</span> <span class="hljs-symbol">:upload</span>}, <span class="hljs-symbol">multipart:</span> <span class="hljs-literal">true</span>) <span class="hljs-keyword">do</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> file_field_tag <span class="hljs-string">'picture'</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|f|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.file_field <span class="hljs-symbol">:picture</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>Rails provides the usual pair of helpers: the barebones <code>file_field_tag</code> and the model oriented <code>file_field</code>. As you would expect in the first case the uploaded file is in <code>params[:picture]</code> and in the second case in <code>params[:person][:picture]</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="what-gets-uploaded"></a><a href="#what-gets-uploaded" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What Gets Uploaded</h3>
<p>The object in the <code>params</code> hash is an instance of <a href="https://api.rubyonrails.org/classes/ActionDispatch/Http/UploadedFile.html"><code>ActionDispatch::Http::UploadedFile</code></a>. The following snippet saves the uploaded file in <code>#{Rails.root}/public/uploads</code> under the same name as the original file.</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">upload</span></span>
  uploaded_file = params[<span class="hljs-symbol">:picture</span>]
  File.open(Rails.root.join(<span class="hljs-string">'public'</span>, <span class="hljs-string">'uploads'</span>, uploaded_file.original_filename), <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">do</span> <span class="hljs-params">|file|</span>
    file.write(uploaded_file.read)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Once a file has been uploaded, there are a multitude of potential tasks, ranging from where to store the files (on Disk, Amazon S3, etc), associating them with models, resizing image files, and generating thumbnails, etc. <a href="/rails-setup/docs/rails/active-storage">Active Storage</a> is designed to assist with these tasks.</p>
<h2><a class="anchor" aria-hidden="true" id="customizing-form-builders"></a><a href="#customizing-form-builders" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Customizing Form Builders</h2>
<p>The object yielded by <code>form_with</code> and <code>fields_for</code> is an instance of <a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormBuilder.html"><code>ActionView::Helpers::FormBuilder</code></a>. Form builders encapsulate the notion of displaying form elements for a single object. While you can write helpers for your forms in the usual way, you can also create subclass <code>ActionView::Helpers::FormBuilder</code> and add the helpers there. For example:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|f|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> text_field_with_label f, <span class="hljs-symbol">:first_name</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>can be replaced with</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person, <span class="hljs-symbol">builder:</span> LabellingFormBuilder <span class="hljs-keyword">do</span> <span class="hljs-params">|f|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.text_field <span class="hljs-symbol">:first_name</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>by defining a <code>LabellingFormBuilder</code> class similar to the following:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LabellingFormBuilder</span> &lt; ActionView::Helpers::<span class="hljs-title">FormBuilder</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">text_field</span><span class="hljs-params">(attribute, options={})</span></span>
    label(attribute) + <span class="hljs-keyword">super</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>If you reuse this frequently you could define a <code>labeled_form_with</code> helper that automatically applies the <code>builder: LabellingFormBuilder</code> option:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">labeled_form_with</span><span class="hljs-params">(<span class="hljs-symbol">model:</span> <span class="hljs-literal">nil</span>, <span class="hljs-symbol">scope:</span> <span class="hljs-literal">nil</span>, <span class="hljs-symbol">url:</span> <span class="hljs-literal">nil</span>, <span class="hljs-symbol">format:</span> <span class="hljs-literal">nil</span>, **options, &amp;block)</span></span>
  options.merge! <span class="hljs-symbol">builder:</span> LabellingFormBuilder
  form_with <span class="hljs-symbol">model:</span> model, <span class="hljs-symbol">scope:</span> scope, <span class="hljs-symbol">url:</span> url, <span class="hljs-symbol">format:</span> format, **options, &amp;block
<span class="hljs-keyword">end</span>
</code></pre>
<p>The form builder used also determines what happens when you do</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> render <span class="hljs-symbol">partial:</span> f </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>If <code>f</code> is an instance of <code>ActionView::Helpers::FormBuilder</code> then this will render the <code>form</code> partial, setting the partial's object to the form builder. If the form builder is of class <code>LabellingFormBuilder</code> then the <code>labelling_form</code> partial would be rendered instead.</p>
<h2><a class="anchor" aria-hidden="true" id="understanding-parameter-naming-conventions"></a><a href="#understanding-parameter-naming-conventions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Understanding Parameter Naming Conventions</h2>
<p>Values from forms can be at the top level of the <code>params</code> hash or nested in another hash. For example, in a standard <code>create</code> action for a Person model, <code>params[:person]</code> would usually be a hash of all the attributes for the person to create. The <code>params</code> hash can also contain arrays, arrays of hashes, and so on.</p>
<p>Fundamentally HTML forms don't know about any sort of structured data, all they generate is name-value pairs, where pairs are just plain strings. The arrays and hashes you see in your application are the result of some parameter naming conventions that Rails uses.</p>
<h3><a class="anchor" aria-hidden="true" id="basic-structures"></a><a href="#basic-structures" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Structures</h3>
<p>The two basic structures are arrays and hashes. Hashes mirror the syntax used for accessing the value in <code>params</code>. For example, if a form contains:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_name"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[name]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Henry"</span>/&gt;</span>
</code></pre>
<p>the <code>params</code> hash will contain</p>
<pre><code class="hljs css language-ruby">{<span class="hljs-string">'person'</span> =&gt; {<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Henry'</span>}}
</code></pre>
<p>and <code>params[:person][:name]</code> will retrieve the submitted value in the controller.</p>
<p>Hashes can be nested as many levels as required, for example:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_address_city"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[address][city]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"New York"</span>/&gt;</span>
</code></pre>
<p>will result in the <code>params</code> hash being</p>
<pre><code class="hljs css language-ruby">{<span class="hljs-string">'person'</span> =&gt; {<span class="hljs-string">'address'</span> =&gt; {<span class="hljs-string">'city'</span> =&gt; <span class="hljs-string">'New York'</span>}}}
</code></pre>
<p>Normally Rails ignores duplicate parameter names. If the parameter name contains an empty set of square brackets <code>[]</code> then they will be accumulated in an array. If you wanted users to be able to input multiple phone numbers, you could place this in the form:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[phone_number][]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[phone_number][]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[phone_number][]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
</code></pre>
<p>This would result in <code>params[:person][:phone_number]</code> being an array containing the inputted phone numbers.</p>
<h3><a class="anchor" aria-hidden="true" id="combining-them"></a><a href="#combining-them" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Combining Them</h3>
<p>We can mix and match these two concepts. One element of a hash might be an array as in the previous example, or you can have an array of hashes. For example, a form might let you create any number of addresses by repeating the following form fragment</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[addresses][][line1]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[addresses][][line2]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[addresses][][city]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[addresses][][line1]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[addresses][][line2]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[addresses][][city]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>/&gt;</span>
</code></pre>
<p>This would result in <code>params[:person][:addresses]</code> being an array of hashes with keys <code>line1</code>, <code>line2</code>, and <code>city</code>.</p>
<p>There's a restriction, however, while hashes can be nested arbitrarily, only one level of &quot;arrayness&quot; is allowed. Arrays can usually be replaced by hashes; for example, instead of having an array of model objects, one can have a hash of model objects keyed by their id, an array index, or some other parameter.</p>
<p>WARNING: Array parameters do not play well with the <code>check_box</code> helper. According to the HTML specification unchecked checkboxes submit no value. However it is often convenient for a checkbox to always submit a value. The <code>check_box</code> helper fakes this by creating an auxiliary hidden input with the same name. If the checkbox is unchecked only the hidden input is submitted and if it is checked then both are submitted but the value submitted by the checkbox takes precedence.</p>
<h3><a class="anchor" aria-hidden="true" id="using-form-helpers"></a><a href="#using-form-helpers" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using Form Helpers</h3>
<p>The previous sections did not use the Rails form helpers at all. While you can craft the input names yourself and pass them directly to helpers such as <code>text_field_tag</code> Rails also provides higher level support. The two tools at your disposal here are the name parameter to <code>form_with</code> and <code>fields_for</code> and the <code>:index</code> option that helpers take.</p>
<p>You might want to render a form with a set of edit fields for each of a person's addresses. For example:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|person_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> person_form.text_field <span class="hljs-symbol">:name</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> @person.addresses.each <span class="hljs-keyword">do</span> <span class="hljs-params">|address|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> person_form.fields_for address, <span class="hljs-symbol">index:</span> address.id <span class="hljs-keyword">do</span> <span class="hljs-params">|address_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> address_form.text_field <span class="hljs-symbol">:city</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>Assuming the person had two addresses, with ids 23 and 45 this would create output similar to this:</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">accept-charset</span>=<span class="hljs-string">"UTF-8"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/people/1"</span> <span class="hljs-attr">data-remote</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"_method"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"patch"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_name"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[name]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_address_23_city"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[address][23][city]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_address_45_city"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[address][45][city]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p>This will result in a <code>params</code> hash that looks like</p>
<pre><code class="hljs css language-ruby">{<span class="hljs-string">'person'</span> =&gt; {<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Bob'</span>, <span class="hljs-string">'address'</span> =&gt; {<span class="hljs-string">'23'</span> =&gt; {<span class="hljs-string">'city'</span> =&gt; <span class="hljs-string">'Paris'</span>}, <span class="hljs-string">'45'</span> =&gt; {<span class="hljs-string">'city'</span> =&gt; <span class="hljs-string">'London'</span>}}}}
</code></pre>
<p>Rails knows that all these inputs should be part of the person hash because you
called <code>fields_for</code> on the first form builder. By specifying an <code>:index</code> option
you're telling Rails that instead of naming the inputs <code>person[address][city]</code>
it should insert that index surrounded by [] between the address and the city.
This is often useful as it is then easy to locate which Address record
should be modified. You can pass numbers with some other significance,
strings or even <code>nil</code> (which will result in an array parameter being created).</p>
<p>To create more intricate nestings, you can specify the first part of the input
name (<code>person[address]</code> in the previous example) explicitly:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> fields_for <span class="hljs-string">'person[address][primary]'</span>, address, <span class="hljs-symbol">index:</span> address.id <span class="hljs-keyword">do</span> <span class="hljs-params">|address_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> address_form.text_field <span class="hljs-symbol">:city</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>will create inputs like</p>
<pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"person_address_primary_1_city"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"person[address][primary][1][city]"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Bologna"</span> /&gt;</span>
</code></pre>
<p>As a general rule the final input name is the concatenation of the name given to <code>fields_for</code>/<code>form_with</code>, the index value, and the name of the attribute. You can also pass an <code>:index</code> option directly to helpers such as <code>text_field</code>, but it is usually less repetitive to specify this at the form builder level rather than on individual input controls.</p>
<p>As a shortcut you can append [] to the name and omit the <code>:index</code> option. This is the same as specifying <code>index: address.id</code> so</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> fields_for <span class="hljs-string">'person[address][primary][]'</span>, address <span class="hljs-keyword">do</span> <span class="hljs-params">|address_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> address_form.text_field <span class="hljs-symbol">:city</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>produces exactly the same output as the previous example.</p>
<h2><a class="anchor" aria-hidden="true" id="forms-to-external-resources"></a><a href="#forms-to-external-resources" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Forms to External Resources</h2>
<p>Rails' form helpers can also be used to build a form for posting data to an external resource. However, at times it can be necessary to set an <code>authenticity_token</code> for the resource; this can be done by passing an <code>authenticity_token: 'your_external_token'</code> parameter to the <code>form_with</code> options:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">url:</span> <span class="hljs-string">'http://farfar.away/form'</span>, <span class="hljs-symbol">authenticity_token:</span> <span class="hljs-string">'external_token'</span> <span class="hljs-keyword">do</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  Form contents
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>Sometimes when submitting data to an external resource, like a payment gateway, the fields that can be used in the form are limited by an external API and it may be undesirable to generate an <code>authenticity_token</code>. To not send a token, simply pass <code>false</code> to the <code>:authenticity_token</code> option:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">url:</span> <span class="hljs-string">'http://farfar.away/form'</span>, <span class="hljs-symbol">authenticity_token:</span> <span class="hljs-literal">false</span> <span class="hljs-keyword">do</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  Form contents
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<h2><a class="anchor" aria-hidden="true" id="building-complex-forms"></a><a href="#building-complex-forms" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building Complex Forms</h2>
<p>Many apps grow beyond simple forms editing a single object. For example, when creating a <code>Person</code> you might want to allow the user to (on the same form) create multiple address records (home, work, etc.). When later editing that person the user should be able to add, remove, or amend addresses as necessary.</p>
<h3><a class="anchor" aria-hidden="true" id="configuring-the-model"></a><a href="#configuring-the-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring the Model</h3>
<p>Active Record provides model level support via the <code>accepts_nested_attributes_for</code> method:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> &lt; ApplicationRecord</span>
  has_many <span class="hljs-symbol">:addresses</span>, <span class="hljs-symbol">inverse_of:</span> <span class="hljs-symbol">:person</span>
  accepts_nested_attributes_for <span class="hljs-symbol">:addresses</span>
<span class="hljs-keyword">end</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span> &lt; ApplicationRecord</span>
  belongs_to <span class="hljs-symbol">:person</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>This creates an <code>addresses_attributes=</code> method on <code>Person</code> that allows you to create, update, and (optionally) destroy addresses.</p>
<h3><a class="anchor" aria-hidden="true" id="nested-forms"></a><a href="#nested-forms" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nested Forms</h3>
<p>The following form allows a user to create a <code>Person</code> and its associated addresses.</p>
<pre><code class="hljs css language-html+erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|f|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  Addresses:
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.fields_for <span class="hljs-symbol">:addresses</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|addresses_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.label <span class="hljs-symbol">:kind</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.text_field <span class="hljs-symbol">:kind</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.label <span class="hljs-symbol">:street</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.text_field <span class="hljs-symbol">:street</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
        ...
      <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>When an association accepts nested attributes <code>fields_for</code> renders its block once for every element of the association. In particular, if a person has no addresses it renders nothing. A common pattern is for the controller to build one or more empty children so that at least one set of fields is shown to the user. The example below would result in 2 sets of address fields being rendered on the new person form.</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">new</span></span>
  @person = Person.new
  <span class="hljs-number">2</span>.times { @person.addresses.build }
<span class="hljs-keyword">end</span>
</code></pre>
<p>The <code>fields_for</code> yields a form builder. The parameters' name will be what
<code>accepts_nested_attributes_for</code> expects. For example, when creating a user with
2 addresses, the submitted parameters would look like:</p>
<pre><code class="hljs css language-ruby">{
  <span class="hljs-string">'person'</span> =&gt; {
    <span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'John Doe'</span>,
    <span class="hljs-string">'addresses_attributes'</span> =&gt; {
      <span class="hljs-string">'0'</span> =&gt; {
        <span class="hljs-string">'kind'</span> =&gt; <span class="hljs-string">'Home'</span>,
        <span class="hljs-string">'street'</span> =&gt; <span class="hljs-string">'221b Baker Street'</span>
      },
      <span class="hljs-string">'1'</span> =&gt; {
        <span class="hljs-string">'kind'</span> =&gt; <span class="hljs-string">'Office'</span>,
        <span class="hljs-string">'street'</span> =&gt; <span class="hljs-string">'31 Spooner Street'</span>
      }
    }
  }
}
</code></pre>
<p>The keys of the <code>:addresses_attributes</code> hash are unimportant, they need merely be different for each address.</p>
<p>If the associated object is already saved, <code>fields_for</code> autogenerates a hidden input with the <code>id</code> of the saved record. You can disable this by passing <code>include_id: false</code> to <code>fields_for</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="the-controller"></a><a href="#the-controller" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Controller</h3>
<p>As usual you need to
<a href="action_controller_overview.html#strong-parameters">declare the permitted parameters</a> in
the controller before you pass them to the model:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create</span></span>
  @person = Person.new(person_params)
  <span class="hljs-comment"># ...</span>
<span class="hljs-keyword">end</span>

private
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">person_params</span></span>
    params.<span class="hljs-keyword">require</span>(<span class="hljs-symbol">:person</span>).permit(<span class="hljs-symbol">:name</span>, <span class="hljs-symbol">addresses_attributes:</span> [<span class="hljs-symbol">:id</span>, <span class="hljs-symbol">:kind</span>, <span class="hljs-symbol">:street</span>])
  <span class="hljs-keyword">end</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="removing-objects"></a><a href="#removing-objects" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Removing Objects</h3>
<p>You can allow users to delete associated objects by passing <code>allow_destroy: true</code> to <code>accepts_nested_attributes_for</code></p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> &lt; ApplicationRecord</span>
  has_many <span class="hljs-symbol">:addresses</span>
  accepts_nested_attributes_for <span class="hljs-symbol">:addresses</span>, <span class="hljs-symbol">allow_destroy:</span> <span class="hljs-literal">true</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>If the hash of attributes for an object contains the key <code>_destroy</code> with a value that
evaluates to <code>true</code> (eg. 1, '1', true, or 'true') then the object will be destroyed.
This form allows users to remove addresses:</p>
<pre><code class="hljs css language-erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> form_with <span class="hljs-symbol">model:</span> @person <span class="hljs-keyword">do</span> <span class="hljs-params">|f|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  Addresses:
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> f.fields_for <span class="hljs-symbol">:addresses</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|addresses_form|</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.check_box <span class="hljs-symbol">:_destroy</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.label <span class="hljs-symbol">:kind</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">%=</span></span></span><span class="ruby"> addresses_form.text_field <span class="hljs-symbol">:kind</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
        ...
      <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">%</span></span></span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml"><span class="hljs-tag">%&gt;</span>
</span></code></pre>
<p>Don't forget to update the permitted params in your controller to also include
the <code>_destroy</code> field:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">person_params</span></span>
  params.<span class="hljs-keyword">require</span>(<span class="hljs-symbol">:person</span>).
    permit(<span class="hljs-symbol">:name</span>, <span class="hljs-symbol">addresses_attributes:</span> [<span class="hljs-symbol">:id</span>, <span class="hljs-symbol">:kind</span>, <span class="hljs-symbol">:street</span>, <span class="hljs-symbol">:_destroy</span>])
<span class="hljs-keyword">end</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="preventing-empty-records"></a><a href="#preventing-empty-records" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Preventing Empty Records</h3>
<p>It is often useful to ignore sets of fields that the user has not filled in. You can control this by passing a <code>:reject_if</code> proc to <code>accepts_nested_attributes_for</code>. This proc will be called with each hash of attributes submitted by the form. If the proc returns <code>false</code> then Active Record will not build an associated object for that hash. The example below only tries to build an address if the <code>kind</code> attribute is set.</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> &lt; ApplicationRecord</span>
  has_many <span class="hljs-symbol">:addresses</span>
  accepts_nested_attributes_for <span class="hljs-symbol">:addresses</span>, <span class="hljs-symbol">reject_if:</span> lambda {<span class="hljs-params">|attributes|</span> attributes[<span class="hljs-string">'kind'</span>].blank?}
<span class="hljs-keyword">end</span>
</code></pre>
<p>As a convenience you can instead pass the symbol <code>:all_blank</code> which will create a proc that will reject records where all the attributes are blank excluding any value for <code>_destroy</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="adding-fields-on-the-fly"></a><a href="#adding-fields-on-the-fly" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding Fields on the Fly</h3>
<p>Rather than rendering multiple sets of fields ahead of time you may wish to add them only when a user clicks on an 'Add new address' button. Rails does not provide any built-in support for this. When generating new sets of fields you must ensure the key of the associated array is unique - the current JavaScript date (milliseconds since the <a href="https://en.wikipedia.org/wiki/Unix_time">epoch</a>) is a common choice.</p>
<h2><a class="anchor" aria-hidden="true" id="using-form_for-and-form_tag"></a><a href="#using-form_for-and-form_tag" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using form_for and form_tag</h2>
<p>Before <code>form_with</code> was introduced in Rails 5.1 its functionality used to be split between <code>form_tag</code> and <code>form_for</code>. Both are now soft-deprecated. Documentation on their usage can be found in <a href="https://guides.rubyonrails.org/v5.2/form_helpers.html">older versions of this guide</a>.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2019-7-7</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/rails-setup/docs/rails/action-view"><span class="arrow-prev">← </span><span>Action View Overview</span></a><a class="docs-next button" href="/rails-setup/docs/rails/action-controller"><span>Action Controller Overview</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#dealing-with-basic-forms">Dealing with Basic Forms</a><ul class="toc-headings"><li><a href="#a-generic-search-form">A Generic Search Form</a></li><li><a href="#helpers-for-generating-form-elements">Helpers for Generating Form Elements</a></li><li><a href="#other-helpers-of-interest">Other Helpers of Interest</a></li></ul></li><li><a href="#dealing-with-model-objects">Dealing with Model Objects</a><ul class="toc-headings"><li><a href="#model-object-helpers">Model Object Helpers</a></li><li><a href="#binding-a-form-to-an-object">Binding a Form to an Object</a></li><li><a href="#relying-on-record-identification">Relying on Record Identification</a></li><li><a href="#how-do-forms-with-patch-put-or-delete-methods-work">How do forms with PATCH, PUT, or DELETE methods work?</a></li></ul></li><li><a href="#making-select-boxes-with-ease">Making Select Boxes with Ease</a><ul class="toc-headings"><li><a href="#the-select-and-option-tags">The Select and Option Tags</a></li><li><a href="#select-boxes-for-dealing-with-model-objects">Select Boxes for Dealing with Model Objects</a></li><li><a href="#option-tags-from-a-collection-of-arbitrary-objects">Option Tags from a Collection of Arbitrary Objects</a></li><li><a href="#time-zone-and-country-select">Time Zone and Country Select</a></li></ul></li><li><a href="#using-date-and-time-form-helpers">Using Date and Time Form Helpers</a><ul class="toc-headings"><li><a href="#barebones-helpers">Barebones Helpers</a></li><li><a href="#model-object-helpers-1">Model Object Helpers</a></li><li><a href="#common-options">Common Options</a></li><li><a href="#individual-components">Individual Components</a></li></ul></li><li><a href="#uploading-files">Uploading Files</a><ul class="toc-headings"><li><a href="#what-gets-uploaded">What Gets Uploaded</a></li></ul></li><li><a href="#customizing-form-builders">Customizing Form Builders</a></li><li><a href="#understanding-parameter-naming-conventions">Understanding Parameter Naming Conventions</a><ul class="toc-headings"><li><a href="#basic-structures">Basic Structures</a></li><li><a href="#combining-them">Combining Them</a></li><li><a href="#using-form-helpers">Using Form Helpers</a></li></ul></li><li><a href="#forms-to-external-resources">Forms to External Resources</a></li><li><a href="#building-complex-forms">Building Complex Forms</a><ul class="toc-headings"><li><a href="#configuring-the-model">Configuring the Model</a></li><li><a href="#nested-forms">Nested Forms</a></li><li><a href="#the-controller">The Controller</a></li><li><a href="#removing-objects">Removing Objects</a></li><li><a href="#preventing-empty-records">Preventing Empty Records</a></li><li><a href="#adding-fields-on-the-fly">Adding Fields on the Fly</a></li></ul></li><li><a href="#using-form_for-and-form_tag">Using form_for and form_tag</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Rails Setup 2019</section></footer></div></body></html>